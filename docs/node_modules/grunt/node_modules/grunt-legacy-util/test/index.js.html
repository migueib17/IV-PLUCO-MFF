<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>. documentation: node_modules/grunt/node_modules/grunt-legacy-util/test/index.js</title>
  <link rel="stylesheet" href="../../../../../pyccoon.css">
</head>
<body>
<div id='container' >
  <div id="footer">
    <span id="project-name">
        <a class="btn" href="../../../../../index.html">. documentation</a>
    </span>
    <a class="btn" class="source source-1" href="#top">Back to top</a>
    <div class="generation-time">
        Generated at
        <code>2015-10-31 20:21</code>
        by a diligent
        <a target="_blank" href="http://ckald.github.io/pyccoon/" title="Pyccoon: side-to-side documentation generator">
            <img id="pyccoon-icon" src="../../../../../pyccoon_icon.svg" alt="Pyccoon: side-to-side documentation generator" />pyccoon</a>
    </div>
  </div>
  <a id="top"></a>
  <div class='section'>
    <div class='docs nav'>
      <nav id="breadcrumbs">/ <a href="index.js.html/../../../../../../index.html">.</a> / <a href="index.js.html/../../../../../index.html">node_modules</a> / <a href="index.js.html/../../../../index.html">grunt</a> / <a href="index.js.html/../../../index.html">node_modules</a> / <a href="index.js.html/../../index.html">grunt-legacy-util</a> / <a href="index.js.html/../index.html">test</a> / index.js</nav>
      <ul id="children"><li><a href="fixtures/index.html" class="directory">fixtures</a></li><li><a href="index.js.html">index.js</a></li></ul>
    </div>
  </div>
  <div id="everything" class='clearall'>
    <div id="background"></div>
    <div class='section'>
    <a id="section-0" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-0'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">util</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">Tempfile</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;temporary/lib/file&#39;</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">[</span><span class="s1">&#39;util.callbackify&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>

  <span class="s1">&#39;return&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-1" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-1'>#</a>
          </div>
          <p>This function returns a value.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
    <span class="p">}</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-2" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-2'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">util</span><span class="p">.</span><span class="nx">callbackify</span><span class="p">(</span><span class="nx">add</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;should be the correct result.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-3" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-3'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;callback (sync)&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-4" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-4'>#</a>
          </div>
          <p>This function accepts a callback which it calls synchronously.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">done</span><span class="p">(</span><span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">);</span>
    <span class="p">}</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-5" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-5'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">util</span><span class="p">.</span><span class="nx">callbackify</span><span class="p">(</span><span class="nx">add</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;should be the correct result.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-6" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-6'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;callback (async)&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-7" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-7'>#</a>
          </div>
          <p>This function accepts a callback which it calls asynchronously.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">add</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">done</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-8" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-8'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">util</span><span class="p">.</span><span class="nx">callbackify</span><span class="p">(</span><span class="nx">add</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;should be the correct result.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">[</span><span class="s1">&#39;util&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-9" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-9'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;error&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">origError</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Original error.&#39;</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">err</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Test message.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="nx">err</span> <span class="k">instanceof</span> <span class="nb">Error</span><span class="p">,</span> <span class="s1">&#39;Should be an Error.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Should be an Error.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span> <span class="s1">&#39;Test message.&#39;</span><span class="p">,</span> <span class="s1">&#39;Should have the correct message.&#39;</span><span class="p">);</span>

    <span class="nx">err</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Test message.&#39;</span><span class="p">,</span> <span class="nx">origError</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="nx">err</span> <span class="k">instanceof</span> <span class="nb">Error</span><span class="p">,</span> <span class="s1">&#39;Should be an Error.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Should be an Error.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span> <span class="s1">&#39;Test message.&#39;</span><span class="p">,</span> <span class="s1">&#39;Should have the correct message.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">origError</span><span class="p">,</span> <span class="nx">origError</span><span class="p">,</span> <span class="s1">&#39;Should reflect the original error.&#39;</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">newError</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Test message.&#39;</span><span class="p">);</span>
    <span class="nx">err</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">newError</span><span class="p">,</span> <span class="nx">origError</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">newError</span><span class="p">,</span> <span class="s1">&#39;Should be the passed-in Error.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">origError</span><span class="p">,</span> <span class="nx">origError</span><span class="p">,</span> <span class="s1">&#39;Should reflect the original error.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-10" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-10'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;linefeed&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">platform</span> <span class="o">===</span> <span class="s1">&#39;win32&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">linefeed</span><span class="p">,</span> <span class="s1">&#39;\r\n&#39;</span><span class="p">,</span> <span class="s1">&#39;linefeed should be operating-system appropriate.&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">linefeed</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">,</span> <span class="s1">&#39;linefeed should be operating-system appropriate.&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-11" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-11'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;normalizelf&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">platform</span> <span class="o">===</span> <span class="s1">&#39;win32&#39;</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">normalizelf</span><span class="p">(</span><span class="s1">&#39;foo\nbar\r\nbaz\r\n\r\nqux\n\nquux&#39;</span><span class="p">),</span> <span class="s1">&#39;foo\r\nbar\r\nbaz\r\n\r\nqux\r\n\r\nquux&#39;</span><span class="p">,</span> <span class="s1">&#39;linefeeds should be normalized&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">normalizelf</span><span class="p">(</span><span class="s1">&#39;foo\nbar\r\nbaz\r\n\r\nqux\n\nquux&#39;</span><span class="p">),</span> <span class="s1">&#39;foo\nbar\nbaz\n\nqux\n\nquux&#39;</span><span class="p">,</span> <span class="s1">&#39;linefeeds should be normalized&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">[</span><span class="s1">&#39;util.spawn&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-12" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-12'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="nx">setUp</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">script</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s1">&#39;test/fixtures/spawn.js&#39;</span><span class="p">);</span>
    <span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-13" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-13'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;exit code 0&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">execPath</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">script</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="s1">&#39;stdout&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s1">&#39;stderr&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span> <span class="s1">&#39;stdout&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-14" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-14'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;exit code 0, fallback&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">execPath</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">script</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>
      <span class="nx">fallback</span><span class="o">:</span> <span class="s1">&#39;ignored if exit code is 0&#39;</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="s1">&#39;stdout&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s1">&#39;stderr&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span> <span class="s1">&#39;stdout&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-15" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-15'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;non-zero exit code&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">execPath</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">script</span><span class="p">,</span> <span class="mi">123</span> <span class="p">],</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="nx">err</span> <span class="k">instanceof</span> <span class="nb">Error</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span> <span class="s1">&#39;stderr&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="s1">&#39;stdout&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s1">&#39;stderr&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span> <span class="s1">&#39;stderr&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-16" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-16'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;non-zero exit code, fallback&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">execPath</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">script</span><span class="p">,</span> <span class="mi">123</span> <span class="p">],</span>
      <span class="nx">fallback</span><span class="o">:</span> <span class="s1">&#39;custom fallback&#39;</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="s1">&#39;stdout&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s1">&#39;stderr&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="mi">123</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span> <span class="s1">&#39;custom fallback&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-17" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-17'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;cmd not found&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="s1">&#39;nodewtfmisspelled&#39;</span><span class="p">,</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="nx">err</span> <span class="k">instanceof</span> <span class="nb">Error</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-18" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-18'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;cmd not found, fallback&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="s1">&#39;nodewtfmisspelled&#39;</span><span class="p">,</span>
      <span class="nx">fallback</span><span class="o">:</span> <span class="s1">&#39;use a fallback or good luck&#39;</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span> <span class="s1">&#39;use a fallback or good luck&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-19" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-19'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;cmd not in path&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">win32</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">platform</span> <span class="o">===</span> <span class="s1">&#39;win32&#39;</span><span class="p">;</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="s1">&#39;test\\fixtures\\exec&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">win32</span> <span class="o">?</span> <span class="s1">&#39;.cmd&#39;</span> <span class="o">:</span> <span class="s1">&#39;.sh&#39;</span><span class="p">),</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span> <span class="s1">&#39;done&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-20" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-20'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;cmd not in path (with cwd)&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">win32</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">platform</span> <span class="o">===</span> <span class="s1">&#39;win32&#39;</span><span class="p">;</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="s1">&#39;./exec&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">win32</span> <span class="o">?</span> <span class="s1">&#39;.cmd&#39;</span> <span class="o">:</span> <span class="s1">&#39;.sh&#39;</span><span class="p">),</span>
      <span class="nx">opts</span><span class="o">:</span> <span class="p">{</span><span class="nx">cwd</span><span class="o">:</span> <span class="s1">&#39;test/fixtures&#39;</span><span class="p">},</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="s1">&#39;done&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">result</span><span class="p">),</span> <span class="s1">&#39;done&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-21" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-21'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;grunt&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">grunt</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;--gruntfile&#39;</span><span class="p">,</span> <span class="s1">&#39;test/fixtures/Gruntfile-print-text.js&#39;</span><span class="p">,</span> <span class="s1">&#39;print:foo&#39;</span> <span class="p">],</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="sr">/^OUTPUT: foo/m</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">),</span> <span class="s1">&#39;stdout should contain output indicating the grunt task was run.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-22" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-22'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;grunt (with cwd)&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">grunt</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;--gruntfile&#39;</span><span class="p">,</span> <span class="s1">&#39;Gruntfile-print-text.js&#39;</span><span class="p">,</span> <span class="s1">&#39;print:foo&#39;</span> <span class="p">],</span>
      <span class="nx">opts</span><span class="o">:</span> <span class="p">{</span><span class="nx">cwd</span><span class="o">:</span> <span class="s1">&#39;test/fixtures&#39;</span><span class="p">},</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="sr">/^OUTPUT: foo/m</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">),</span> <span class="s1">&#39;stdout should contain output indicating the grunt task was run.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-23" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-23'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;grunt passes execArgv&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">execPath</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;--harmony&#39;</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--gruntfile&#39;</span><span class="p">,</span> <span class="s1">&#39;test/fixtures/Gruntfile-execArgv.js&#39;</span><span class="p">],</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="sr">/^OUTPUT: --harmony/m</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">),</span> <span class="s1">&#39;stdout should contain passed-through process.execArgv.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-24" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-24'>#</a>
          </div>
          <p>grunt.log.error uses standard out, to be fixed in 0.5.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;grunt result.toString() with error&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">grunt</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;nonexistentTask&#39;</span> <span class="p">]</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-25" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-25'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="nx">err</span> <span class="k">instanceof</span> <span class="nb">Error</span><span class="p">,</span> <span class="s1">&#39;Should be an Error.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="s1">&#39;Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Should be an Error.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="sr">/Warning: Task &quot;nonexistentTask&quot; not found./m</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">toString</span><span class="p">()),</span> <span class="s1">&#39;stdout should contain output indicating the grunt task was (attempted to be) run.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-26" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-26'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;custom stdio stream(s)&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">stdoutFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tempfile</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">stderrFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Tempfile</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">stdout</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">openSync</span><span class="p">(</span><span class="nx">stdoutFile</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">stderr</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">openSync</span><span class="p">(</span><span class="nx">stderrFile</span><span class="p">.</span><span class="nx">path</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">execPath</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">script</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>
      <span class="nx">opts</span><span class="o">:</span> <span class="p">{</span><span class="nx">stdio</span><span class="o">:</span> <span class="p">[</span><span class="kc">null</span><span class="p">,</span> <span class="nx">stdout</span><span class="p">,</span> <span class="nx">stderr</span><span class="p">]},</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">stdoutFile</span><span class="p">.</span><span class="nx">path</span><span class="p">)),</span> <span class="s1">&#39;stdout\n&#39;</span><span class="p">,</span> <span class="s1">&#39;Child process stdout should have been captured via custom stream.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nb">String</span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">stderrFile</span><span class="p">.</span><span class="nx">path</span><span class="p">)),</span> <span class="s1">&#39;stderr\n&#39;</span><span class="p">,</span> <span class="s1">&#39;Child process stderr should have been captured via custom stream.&#39;</span><span class="p">);</span>
      <span class="nx">stdoutFile</span><span class="p">.</span><span class="nx">unlinkSync</span><span class="p">();</span>
      <span class="nx">stderrFile</span><span class="p">.</span><span class="nx">unlinkSync</span><span class="p">();</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Nothing will be passed to the stdout string when spawn stdio is a custom stream.&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="o">!</span><span class="nx">child</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="s1">&#39;child should not have a stdout property.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="o">!</span><span class="nx">child</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s1">&#39;child should not have a stderr property.&#39;</span><span class="p">);</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="nx">exports</span><span class="p">[</span><span class="s1">&#39;util.spawn.multibyte&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-27" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-27'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="nx">setUp</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">script</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s1">&#39;test/fixtures/spawn-multibyte.js&#39;</span><span class="p">);</span>
    <span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-28" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-28'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;partial stdout&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
    <span class="nx">util</span><span class="p">.</span><span class="nx">spawn</span><span class="p">({</span>
      <span class="nx">cmd</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">execPath</span><span class="p">,</span>
      <span class="nx">args</span><span class="o">:</span> <span class="p">[</span> <span class="k">this</span><span class="p">.</span><span class="nx">script</span> <span class="p">],</span>

    <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">result</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">stderr</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-29" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-29'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre><span class="nx">exports</span><span class="p">[</span><span class="s1">&#39;util.underscore.string&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
  <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">_</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="s1">&#39;    foo     &#39;</span><span class="p">),</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;Should have trimmed the string.&#39;</span><span class="p">);</span>
  <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">_</span><span class="p">.</span><span class="nx">capitalize</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">),</span> <span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="s1">&#39;Should have capitalized the first letter.&#39;</span><span class="p">);</span>
  <span class="nx">test</span><span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">_</span><span class="p">.</span><span class="nx">words</span><span class="p">(</span><span class="s1">&#39;one two three&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Should have counted three words.&#39;</span><span class="p">);</span>
  <span class="nx">test</span><span class="p">.</span><span class="nx">ok</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">_</span><span class="p">.</span><span class="nx">isBlank</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">),</span> <span class="s1">&#39;Should be blank.&#39;</span><span class="p">);</span>
  <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
<span class="p">};</span>

<span class="kd">function</span> <span class="nx">getType</span><span class="p">(</span><span class="nx">val</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">Buffer</span><span class="p">.</span><span class="nx">isBuffer</span><span class="p">(</span><span class="nx">val</span><span class="p">))</span> <span class="p">{</span> <span class="k">return</span> <span class="s1">&#39;buffer&#39;</span><span class="p">;</span> <span class="p">}</span>
  <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">val</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">exports</span><span class="p">[</span><span class="s1">&#39;util.recurse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>

  <span class="nx">setUp</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-30" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-30'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">typeValue</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="nx">value</span><span class="o">:</span> <span class="nx">value</span><span class="p">,</span>
        <span class="nx">type</span><span class="o">:</span> <span class="nx">getType</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span>
      <span class="p">};</span>
    <span class="p">};</span>
    <span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-31" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-31'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;primitives&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">({</span>
      <span class="nx">bool</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">num</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="nx">str</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
      <span class="nx">nul</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="nx">undef</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">typeValue</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">expected</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">bool</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;boolean&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
      <span class="nx">num</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
      <span class="nx">str</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">},</span>
      <span class="nx">nul</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="p">},</span>
      <span class="nx">undef</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">},</span>
    <span class="p">};</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">deepEqual</span><span class="p">(</span><span class="nx">actual</span><span class="p">,</span> <span class="nx">expected</span><span class="p">,</span> <span class="s1">&#39;Should process primitive values.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-32" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-32'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;array&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">({</span>
      <span class="nx">arr</span><span class="o">:</span> <span class="p">[</span>
        <span class="kc">true</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
        <span class="kc">null</span><span class="p">,</span>
        <span class="kc">undefined</span><span class="p">,</span>
        <span class="p">[</span>
          <span class="kc">true</span><span class="p">,</span>
          <span class="mi">1</span><span class="p">,</span>
          <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
          <span class="kc">null</span><span class="p">,</span>
          <span class="kc">undefined</span><span class="p">,</span>
        <span class="p">],</span>
      <span class="p">],</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">typeValue</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">expected</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">arr</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;boolean&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">},</span>
        <span class="p">[</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;boolean&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">},</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="p">},</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">},</span>
        <span class="p">],</span>
      <span class="p">],</span>
    <span class="p">};</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">deepEqual</span><span class="p">(</span><span class="nx">actual</span><span class="p">,</span> <span class="nx">expected</span><span class="p">,</span> <span class="s1">&#39;Should recurse over arrays.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-33" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-33'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;object&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">({</span>
      <span class="nx">obj</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">bool</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">num</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">str</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
        <span class="nx">nul</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nx">undef</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
        <span class="nx">obj</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">bool</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nx">num</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="nx">str</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
          <span class="nx">nul</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
          <span class="nx">undef</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
        <span class="p">},</span>
      <span class="p">},</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">typeValue</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">expected</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">obj</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">bool</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;boolean&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
        <span class="nx">num</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="nx">str</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">},</span>
        <span class="nx">nul</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="p">},</span>
        <span class="nx">undef</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">},</span>
        <span class="nx">obj</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">bool</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;boolean&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
          <span class="nx">num</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="nx">str</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">},</span>
          <span class="nx">nul</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="p">},</span>
          <span class="nx">undef</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">},</span>
        <span class="p">},</span>
      <span class="p">},</span>
    <span class="p">};</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">deepEqual</span><span class="p">(</span><span class="nx">actual</span><span class="p">,</span> <span class="nx">expected</span><span class="p">,</span> <span class="s1">&#39;Should recurse over objects.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-34" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-34'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;array in object&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">({</span>
      <span class="nx">obj</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">arr</span><span class="o">:</span> <span class="p">[</span>
          <span class="kc">true</span><span class="p">,</span>
          <span class="mi">1</span><span class="p">,</span>
          <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
          <span class="kc">null</span><span class="p">,</span>
          <span class="kc">undefined</span><span class="p">,</span>
        <span class="p">],</span>
      <span class="p">},</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">typeValue</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">expected</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">obj</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">arr</span><span class="o">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;boolean&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">},</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="p">},</span>
          <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">},</span>
        <span class="p">],</span>
      <span class="p">},</span>
    <span class="p">};</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">deepEqual</span><span class="p">(</span><span class="nx">actual</span><span class="p">,</span> <span class="nx">expected</span><span class="p">,</span> <span class="s1">&#39;Should recurse over arrays in objects.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-35" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-35'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;object in array&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">({</span>
      <span class="nx">arr</span><span class="o">:</span> <span class="p">[</span>
        <span class="kc">true</span><span class="p">,</span>
        <span class="p">{</span>
          <span class="nx">num</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
          <span class="nx">str</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="kc">null</span><span class="p">,</span>
        <span class="kc">undefined</span><span class="p">,</span>
      <span class="p">],</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">typeValue</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">expected</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">arr</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;boolean&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
        <span class="p">{</span>
          <span class="nx">num</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
          <span class="nx">str</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">},</span>
        <span class="p">},</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;null&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">null</span><span class="p">},</span>
        <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;undefined&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">},</span>
      <span class="p">],</span>
    <span class="p">};</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">deepEqual</span><span class="p">(</span><span class="nx">actual</span><span class="p">,</span> <span class="nx">expected</span><span class="p">,</span> <span class="s1">&#39;Should recurse over objects in arrays.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-36" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-36'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;buffer&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">({</span>
      <span class="nx">buf</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Buffer</span><span class="p">(</span><span class="s1">&#39;buf&#39;</span><span class="p">),</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">typeValue</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">expected</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">buf</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;buffer&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Buffer</span><span class="p">(</span><span class="s1">&#39;buf&#39;</span><span class="p">)},</span>
    <span class="p">};</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">deepEqual</span><span class="p">(</span><span class="nx">actual</span><span class="p">,</span> <span class="nx">expected</span><span class="p">,</span> <span class="s1">&#39;Should not mangle Buffer instances.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-37" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-37'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;inherited properties&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">actual</span> <span class="o">=</span> <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">({</span>
      <span class="nx">obj</span><span class="o">:</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">num</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span>
        <span class="nx">str</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
        <span class="nx">ignored</span><span class="o">:</span> <span class="p">{</span><span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;ignored&#39;</span><span class="p">,</span> <span class="nx">enumerable</span><span class="o">:</span> <span class="kc">false</span><span class="p">},</span>
      <span class="p">}),</span>
    <span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">typeValue</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">expected</span> <span class="o">=</span> <span class="p">{</span>
      <span class="nx">obj</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">num</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="nx">str</span><span class="o">:</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;foo&#39;</span><span class="p">},</span>
      <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">deepEqual</span><span class="p">(</span><span class="nx">actual</span><span class="p">,</span> <span class="nx">expected</span><span class="p">,</span> <span class="s1">&#39;Should enumerate inherited object properties.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-38" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-38'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="s1">&#39;circular references&#39;</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">6</span><span class="p">);</span>
    <span class="kd">function</span> <span class="nx">assertErrorWithPath</span><span class="p">(</span><span class="nx">expectedPath</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">actual</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">actual</span><span class="p">.</span><span class="nx">path</span> <span class="o">===</span> <span class="nx">expectedPath</span> <span class="o">&amp;&amp;</span>
          <span class="nx">actual</span><span class="p">.</span><span class="nx">message</span> <span class="o">===</span> <span class="s1">&#39;Circular reference detected (&#39;</span> <span class="o">+</span> <span class="nx">expectedPath</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
      <span class="p">};</span>
    <span class="p">}</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-39" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-39'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">test</span><span class="p">.</span><span class="nx">doesNotThrow</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-40" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-40'>#</a>
          </div>
          <p>wat</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="nx">a</span><span class="o">:</span><span class="p">[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]],</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-41" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-41'>#</a>
          </div>
          <p>does</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="nx">b</span><span class="o">:</span><span class="p">[[[[],[[[],[[[[],[[[],[[[],[[[],[[[],[[[[],[[]]]]]]]]]]]]]]]]]]]]],</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-42" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-42'>#</a>
          </div>
          <p>it</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="nx">c</span><span class="o">:</span><span class="p">{</span><span class="nx">d</span><span class="o">:</span><span class="p">{</span><span class="nx">e</span><span class="o">:</span><span class="p">{</span><span class="nx">f</span><span class="o">:</span><span class="p">{</span><span class="nx">g</span><span class="o">:</span><span class="p">{</span><span class="nx">h</span><span class="o">:</span><span class="p">{</span><span class="nx">i</span><span class="o">:</span><span class="p">{</span><span class="nx">j</span><span class="o">:</span><span class="p">{</span><span class="nx">k</span><span class="o">:</span><span class="p">{</span><span class="nx">l</span><span class="o">:</span><span class="p">{</span><span class="nx">m</span><span class="o">:</span><span class="p">{</span><span class="nx">n</span><span class="o">:</span><span class="p">{</span><span class="nx">o</span><span class="o">:</span><span class="p">{</span><span class="nx">p</span><span class="o">:</span><span class="p">{</span><span class="nx">q</span><span class="o">:</span><span class="p">{</span><span class="nx">r</span><span class="o">:</span><span class="p">{</span><span class="nx">s</span><span class="o">:</span><span class="p">{}}}}}}}}}}}}}}}}},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-43" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-43'>#</a>
          </div>
          <p>mean</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="nx">t</span><span class="o">:</span><span class="p">[{</span><span class="nx">u</span><span class="o">:</span><span class="p">[{</span><span class="nx">v</span><span class="o">:</span><span class="p">[[[[],[[[],[[[{</span><span class="nx">w</span><span class="o">:</span><span class="p">[{</span><span class="nx">x</span><span class="o">:</span><span class="p">[[[],[[[{</span><span class="nx">y</span><span class="o">:</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]}]]]]]}]}]]]]]]]]}]}],</span>
      <span class="p">};</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-44" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-44'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">v</span><span class="p">;</span> <span class="p">});</span>
    <span class="p">},</span> <span class="s1">&#39;Should not throw when no circular reference is detected.&#39;</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-45" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-45'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">test</span><span class="p">.</span><span class="kr">throws</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">2</span><span class="p">};</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>

      <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">v</span><span class="p">;</span> <span class="p">});</span>
    <span class="p">},</span> <span class="nx">assertErrorWithPath</span><span class="p">(</span><span class="s1">&#39;.obj&#39;</span><span class="p">),</span> <span class="s1">&#39;Should throw when a circular reference is detected.&#39;</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-46" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-46'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">test</span><span class="p">.</span><span class="kr">throws</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;b b&#39;</span><span class="o">:</span><span class="p">{</span><span class="s1">&#39;c-c&#39;</span><span class="o">:</span><span class="p">{</span><span class="nx">d_d</span><span class="o">:</span><span class="p">{</span><span class="nx">e</span><span class="o">:</span><span class="p">{</span><span class="nx">f</span><span class="o">:</span><span class="p">{</span><span class="nx">g</span><span class="o">:</span><span class="p">{</span><span class="nx">h</span><span class="o">:</span><span class="p">{</span><span class="nx">i</span><span class="o">:</span><span class="p">{</span><span class="nx">j</span><span class="o">:</span><span class="p">{</span><span class="nx">k</span><span class="o">:</span><span class="p">{</span><span class="nx">l</span><span class="o">:</span><span class="p">{}}}}}}}}}}}}};</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">a</span><span class="p">[</span><span class="s1">&#39;b b&#39;</span><span class="p">][</span><span class="s1">&#39;c-c&#39;</span><span class="p">].</span><span class="nx">d_d</span><span class="p">.</span><span class="nx">e</span><span class="p">.</span><span class="nx">f</span><span class="p">.</span><span class="nx">g</span><span class="p">.</span><span class="nx">h</span><span class="p">.</span><span class="nx">i</span><span class="p">.</span><span class="nx">j</span><span class="p">.</span><span class="nx">k</span><span class="p">.</span><span class="nx">l</span><span class="p">.</span><span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>

      <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">v</span><span class="p">;</span> <span class="p">});</span>
    <span class="p">},</span> <span class="nx">assertErrorWithPath</span><span class="p">(</span><span class="s1">&#39;.a[&quot;b b&quot;][&quot;c-c&quot;].d_d.e.f.g.h.i.j.k.l.obj&#39;</span><span class="p">),</span> <span class="s1">&#39;Should throw when a circular reference is detected.&#39;</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-47" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-47'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">test</span><span class="p">.</span><span class="kr">throws</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">2</span><span class="p">};</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">obj</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>

      <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">v</span><span class="p">;</span> <span class="p">});</span>
    <span class="p">},</span> <span class="nx">assertErrorWithPath</span><span class="p">(</span><span class="s1">&#39;.arr[2]&#39;</span><span class="p">),</span> <span class="s1">&#39;Should throw when a circular reference is detected.&#39;</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-48" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-48'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">test</span><span class="p">.</span><span class="kr">throws</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">2</span><span class="p">};</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">arr</span> <span class="o">=</span> <span class="p">[{</span><span class="nx">a</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,{</span><span class="nx">b</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,{</span><span class="nx">c</span><span class="o">:</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="nx">obj</span><span class="p">,</span><span class="mi">4</span><span class="p">]},</span><span class="mi">5</span><span class="p">]},</span><span class="mi">6</span><span class="p">]},</span><span class="mi">7</span><span class="p">];</span>

      <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">v</span><span class="p">;</span> <span class="p">});</span>
    <span class="p">},</span> <span class="nx">assertErrorWithPath</span><span class="p">(</span><span class="s1">&#39;.arr[0].a[1].b[1].c[1]&#39;</span><span class="p">),</span> <span class="s1">&#39;Should throw when a circular reference is detected.&#39;</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-49" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-49'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">test</span><span class="p">.</span><span class="kr">throws</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">2</span><span class="p">};</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">arr</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">arr</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="mi">0</span><span class="p">,{</span><span class="nx">a</span><span class="o">:</span><span class="p">[</span><span class="mi">1</span><span class="p">,{</span><span class="nx">b</span><span class="o">:</span><span class="p">[</span><span class="mi">2</span><span class="p">,{</span><span class="nx">c</span><span class="o">:</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="nx">obj</span><span class="p">.</span><span class="nx">arr</span><span class="p">,</span><span class="mi">4</span><span class="p">]},</span><span class="mi">5</span><span class="p">]},</span><span class="mi">6</span><span class="p">]},</span><span class="mi">7</span><span class="p">);</span>

      <span class="nx">util</span><span class="p">.</span><span class="nx">recurse</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">v</span><span class="p">;</span> <span class="p">});</span>
    <span class="p">},</span> <span class="nx">assertErrorWithPath</span><span class="p">(</span><span class="s1">&#39;.arr[1].a[1].b[1].c[1]&#39;</span><span class="p">),</span> <span class="s1">&#39;Should throw when a circular reference is detected.&#39;</span><span class="p">);</span>
    <span class="nx">test</span><span class="p">.</span><span class="nx">done</span><span class="p">();</span>
  <span class="p">},</span>
<span class="p">};</span>

</pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
  </div>
</body>
