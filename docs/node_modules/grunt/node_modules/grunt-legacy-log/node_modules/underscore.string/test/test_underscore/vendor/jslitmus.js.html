<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>. documentation: node_modules/grunt/node_modules/grunt-legacy-log/node_modules/underscore.string/test/test_underscore/vendor/jslitmus.js</title>
  <link rel="stylesheet" href="../../../../../../../../../pyccoon.css">
</head>
<body>
<div id='container' >
  <div id="footer">
    <span id="project-name">
        <a class="btn" href="../../../../../../../../../index.html">. documentation</a>
    </span>
    <a class="btn" class="source source-1" href="#top">Back to top</a>
    <div class="generation-time">
        Generated at
        <code>2015-10-31 20:21</code>
        by a diligent
        <a target="_blank" href="http://ckald.github.io/pyccoon/" title="Pyccoon: side-to-side documentation generator">
            <img id="pyccoon-icon" src="../../../../../../../../../pyccoon_icon.svg" alt="Pyccoon: side-to-side documentation generator" />pyccoon</a>
    </div>
  </div>
  <a id="top"></a>
  <div class='section'>
    <div class='docs nav'>
      <nav id="breadcrumbs">/ <a href="jslitmus.js.html/../../../../../../../../../../index.html">.</a> / <a href="jslitmus.js.html/../../../../../../../../../index.html">node_modules</a> / <a href="jslitmus.js.html/../../../../../../../../index.html">grunt</a> / <a href="jslitmus.js.html/../../../../../../../index.html">node_modules</a> / <a href="jslitmus.js.html/../../../../../../index.html">grunt-legacy-log</a> / <a href="jslitmus.js.html/../../../../../index.html">node_modules</a> / <a href="jslitmus.js.html/../../../../index.html">underscore.string</a> / <a href="jslitmus.js.html/../../../index.html">test</a> / <a href="jslitmus.js.html/../../index.html">test_underscore</a> / <a href="jslitmus.js.html/../index.html">vendor</a> / jslitmus.js</nav>
      <ul id="children"></ul>
    </div>
  </div>
  <div id="everything" class='clearall'>
    <div id="background"></div>
    <div class='section'>
    <a id="section-0" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-0'>#</a>
          </div>
          <p>JSLitmus.js</p>
<p>History:
  2008-10-27: Initial release
  2008-11-09: Account for iteration loop overhead
  2008-11-13: Added OS detection
  2009-02-25: Create tinyURL automatically, shift-click runs tests in reverse</p>
<p>Copyright (c) 2008-2009, Robert Kieffer
All Rights Reserved</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the
Software), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to permit
persons to whom the Software is furnished to do so, subject to the
following conditions:</p>
<p>THE SOFTWARE IS PROVIDED AS IS, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-1" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-1'>#</a>
          </div>
          <p>Private methods and state</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-2" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-2'>#</a>
          </div>
          <p>Get platform info but don't go crazy trying to recognize everything
that's out there.  This is just for the major platforms and OSes.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">platform</span> <span class="o">=</span> <span class="s1">&#39;unknown platform&#39;</span><span class="p">,</span> <span class="nx">ua</span> <span class="o">=</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-3" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-3'>#</a>
          </div>
          <p>Detect OS</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">oses</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Windows&#39;</span><span class="p">,</span><span class="s1">&#39;iPhone OS&#39;</span><span class="p">,</span><span class="s1">&#39;(Intel |PPC )?Mac OS X&#39;</span><span class="p">,</span><span class="s1">&#39;Linux&#39;</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">pOS</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;((&#39;</span> <span class="o">+</span> <span class="nx">oses</span> <span class="o">+</span> <span class="s1">&#39;) [^ \);]*)&#39;</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">ua</span><span class="p">)</span> <span class="o">?</span> <span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">pOS</span><span class="p">)</span> <span class="nx">pOS</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;((&#39;</span> <span class="o">+</span> <span class="nx">oses</span> <span class="o">+</span> <span class="s1">&#39;)[^ \);]*)&#39;</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">ua</span><span class="p">)</span> <span class="o">?</span> <span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-4" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-4'>#</a>
          </div>
          <p>Detect browser</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">pName</span> <span class="o">=</span> <span class="sr">/(Chrome|MSIE|Safari|Opera|Firefox)/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">ua</span><span class="p">)</span> <span class="o">?</span> <span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-5" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-5'>#</a>
          </div>
          <p>Detect version</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">vre</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;(Version|&#39;</span> <span class="o">+</span> <span class="nx">pName</span> <span class="o">+</span> <span class="s1">&#39;)[ \/]([^ ;]*)&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">pVersion</span> <span class="o">=</span> <span class="p">(</span><span class="nx">pName</span> <span class="o">&amp;&amp;</span> <span class="nx">vre</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">ua</span><span class="p">))</span> <span class="o">?</span> <span class="nb">RegExp</span><span class="p">.</span><span class="nx">$2</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">platform</span> <span class="o">=</span> <span class="p">(</span><span class="nx">pOS</span> <span class="o">&amp;&amp;</span> <span class="nx">pName</span> <span class="o">&amp;&amp;</span> <span class="nx">pVersion</span><span class="p">)</span> <span class="o">?</span> <span class="nx">pName</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>  <span class="o">+</span> <span class="nx">pVersion</span> <span class="o">+</span> <span class="s1">&#39; on &#39;</span> <span class="o">+</span> <span class="nx">pOS</span> <span class="o">:</span> <span class="s1">&#39;unknown platform&#39;</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-6" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-6'>#</a>
          </div>
          <p>A smattering of methods that are needed to implement the JSLitmus testbed.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">jsl</span> <span class="o">=</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-7" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-7'>#</a>
          </div>
          <p>Enhanced version of escape()</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">escape</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">s</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/,/g</span><span class="p">,</span> <span class="s1">&#39;\\,&#39;</span><span class="p">);</span>
      <span class="nx">s</span> <span class="o">=</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
      <span class="nx">s</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\+/g</span><span class="p">,</span> <span class="s1">&#39;%2b&#39;</span><span class="p">);</span>
      <span class="nx">s</span> <span class="o">=</span> <span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/ /g</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">s</span><span class="p">;</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-8" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-8'>#</a>
          </div>
          <p>Get an element by ID.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">$</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-9" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-9'>#</a>
          </div>
          <p>Null function</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-10" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-10'>#</a>
          </div>
          <p>Set the status shown in the UI</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">F</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-11" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-11'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">status</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;jsl_status&#39;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="nx">el</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">msg</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-12" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-12'>#</a>
          </div>
          <p>Convert a number to an abbreviated string like, "15K" or "10M"</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">toLabel</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">==</span> <span class="kc">Infinity</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;Infinity&#39;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="nx">e9</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">n</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">n</span><span class="o">/</span><span class="mi">1</span><span class="nx">e8</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">n</span><span class="o">/</span><span class="mi">10</span> <span class="o">+</span> <span class="s1">&#39;B&#39;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="nx">e6</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">n</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">n</span><span class="o">/</span><span class="mi">1</span><span class="nx">e5</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">n</span><span class="o">/</span><span class="mi">10</span> <span class="o">+</span> <span class="s1">&#39;M&#39;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="nx">e3</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">n</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">n</span><span class="o">/</span><span class="mi">1</span><span class="nx">e2</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">n</span><span class="o">/</span><span class="mi">10</span> <span class="o">+</span> <span class="s1">&#39;K&#39;</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">n</span><span class="p">;</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-13" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-13'>#</a>
          </div>
          <p>Copy properties from src to dst</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">extend</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dst</span><span class="p">,</span> <span class="nx">src</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">src</span><span class="p">)</span> <span class="nx">dst</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">src</span><span class="p">[</span><span class="nx">k</span><span class="p">];</span> <span class="k">return</span> <span class="nx">dst</span><span class="p">;</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-14" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-14'>#</a>
          </div>
          <p>Like Array.join(), but for the key-value pairs in an object</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">join</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">delimit1</span><span class="p">,</span> <span class="nx">delimit2</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">o</span><span class="p">.</span><span class="nx">join</span><span class="p">)</span> <span class="k">return</span> <span class="nx">o</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">delimit1</span><span class="p">);</span>  <span class="c1">// If it&#39;s an array</span>
      <span class="kd">var</span> <span class="nx">pairs</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">o</span><span class="p">)</span> <span class="nx">pairs</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">k</span> <span class="o">+</span> <span class="nx">delimit1</span> <span class="o">+</span> <span class="nx">o</span><span class="p">[</span><span class="nx">k</span><span class="p">]);</span>
      <span class="k">return</span> <span class="nx">pairs</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">delimit2</span><span class="p">);</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-15" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-15'>#</a>
          </div>
          <p>Array#indexOf isn't supported in IE, so we use this as a cross-browser solution</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">indexOf</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arr</span><span class="p">,</span> <span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">)</span> <span class="k">return</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="nx">arr</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="nx">o</span><span class="p">)</span> <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
      <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">};</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-16" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-16'>#</a>
          </div>
          <p>Test manages a single test (created with
 JSLitmus.test())</p>
<p><span class="pydoc pydoc-private"><span>private</span></span></p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">Test</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">f</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Undefined test function&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="sr">/function[^\(]*\(([^,\)]*)/</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">f</span><span class="p">.</span><span class="nx">toString</span><span class="p">()))</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;&quot; test: Test is not a valid Function object&#39;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">loopArg</span> <span class="o">=</span> <span class="nb">RegExp</span><span class="p">.</span><span class="nx">$1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">f</span> <span class="o">=</span> <span class="nx">f</span><span class="p">;</span>
  <span class="p">};</span>
  
  <span class="nx">jsl</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Test</span><span class="p">,</span> <span class="cm">/** @lends Test */</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-17" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-17'>#</a>
          </div>
          <p>Calibration tests for establishing iteration loop overhead </p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">CALIBRATIONS</span><span class="o">:</span> <span class="p">[</span>

      <span class="k">new</span> <span class="nx">Test</span><span class="p">(</span><span class="s1">&#39;calibrating loop&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">count</span><span class="p">)</span> <span class="p">{</span><span class="k">while</span> <span class="p">(</span><span class="nx">count</span><span class="o">--</span><span class="p">);}),</span>
      <span class="k">new</span> <span class="nx">Test</span><span class="p">(</span><span class="s1">&#39;calibrating function&#39;</span><span class="p">,</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">F</span><span class="p">)</span>
    <span class="p">],</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-18" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-18'>#</a>
          </div>
          <p>Run calibration tests.  Returns true if calibrations are not yet
 complete (in which case calling code should run the tests yet again).
 onCalibrated - Callback to invoke when calibrations have finished</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">calibrate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">onCalibrated</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">Test</span><span class="p">.</span><span class="nx">CALIBRATIONS</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
        <span class="kd">var</span> <span class="nx">cal</span> <span class="o">=</span> <span class="nx">Test</span><span class="p">.</span><span class="nx">CALIBRATIONS</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">cal</span><span class="p">.</span><span class="nx">running</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">cal</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">cal</span><span class="p">.</span><span class="nx">isCalibration</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="nx">cal</span><span class="p">.</span><span class="nx">onStop</span> <span class="o">=</span> <span class="nx">onCalibrated</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-19" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-19'>#</a>
          </div>
          <p>cal.MIN_TIME = .1; // Do calibrations quickly</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="nx">cal</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="mi">2</span><span class="nx">e4</span><span class="p">);</span>
          <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">jsl</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Test</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span><span class="cm">/** @lends Test.prototype */</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-20" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-20'>#</a>
          </div>
          <p>Initial number of iterations </p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">INIT_COUNT</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-21" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-21'>#</a>
          </div>
          <p>Max iterations allowed (i.e. used to detect bad looping functions) </p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">MAX_COUNT</span><span class="o">:</span> <span class="mi">1</span><span class="nx">e9</span><span class="p">,</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-22" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-22'>#</a>
          </div>
          <p>Minimum time a test should take to get valid results (secs) </p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">MIN_TIME</span><span class="o">:</span> <span class="p">.</span><span class="mi">5</span><span class="p">,</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-23" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-23'>#</a>
          </div>
          <p>Callback invoked when test state changes </p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">onChange</span><span class="o">:</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">F</span><span class="p">,</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-24" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-24'>#</a>
          </div>
          <p>Callback invoked when test is finished </p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">onStop</span><span class="o">:</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">F</span><span class="p">,</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-25" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-25'>#</a>
          </div>
          <p>Reset test state</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">reset</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">count</span><span class="p">;</span>
      <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span><span class="p">;</span>
      <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">running</span><span class="p">;</span>
      <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">error</span><span class="p">;</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-26" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-26'>#</a>
          </div>
          <p>Run the test (in a timeout). We use a timeout to make sure the browser
 has a chance to finish rendering any UI changes we've made, like
 updating the status message.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">run</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">count</span> <span class="o">=</span> <span class="nx">count</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">INIT_COUNT</span><span class="p">;</span>
      <span class="nx">jsl</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; x &#39;</span> <span class="o">+</span> <span class="nx">count</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">running</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>

      <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="nx">me</span><span class="p">.</span><span class="nx">_run</span><span class="p">(</span><span class="nx">count</span><span class="p">);},</span> <span class="mi">200</span><span class="p">);</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-27" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-27'>#</a>
          </div>
          <p>The nuts and bolts code that actually runs a test</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">_run</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">me</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-28" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-28'>#</a>
          </div>
          <p>Make sure calibration tests have run</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">me</span><span class="p">.</span><span class="nx">isCalibration</span> <span class="o">&amp;&amp;</span> <span class="nx">Test</span><span class="p">.</span><span class="nx">calibrate</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="nx">me</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="nx">count</span><span class="p">);}))</span> <span class="k">return</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

      <span class="k">try</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">start</span><span class="p">,</span> <span class="nx">f</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">f</span><span class="p">,</span> <span class="nx">now</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">count</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-29" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-29'>#</a>
          </div>
          <p>Start the timer</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="nx">start</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-30" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-30'>#</a>
          </div>
          <p>Now for the money shot.  If this is a looping function ...</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">loopArg</span><span class="p">)</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-31" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-31'>#</a>
          </div>
          <p>... let it do the iteration itself</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="nx">f</span><span class="p">(</span><span class="nx">count</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-32" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-32'>#</a>
          </div>
          <p>... otherwise do the iteration for it</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="k">while</span> <span class="p">(</span><span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="nx">f</span><span class="p">();</span>
        <span class="p">}</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-33" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-33'>#</a>
          </div>
          <p>Get time test took (in secs)</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="o">-</span> <span class="nx">start</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-34" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-34'>#</a>
          </div>
          <p>Store iteration count and per-operation time taken</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">count</span> <span class="o">=</span> <span class="nx">count</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">period</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span><span class="o">/</span><span class="nx">count</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-35" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-35'>#</a>
          </div>
          <p>Do we need to do another run?</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">running</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span> <span class="o">&lt;=</span> <span class="k">this</span><span class="p">.</span><span class="nx">MIN_TIME</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-36" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-36'>#</a>
          </div>
          <p>... if so, compute how many times we should iterate</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">running</span><span class="p">)</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-37" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-37'>#</a>
          </div>
          <p>Bump the count to the nearest power of 2</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">MIN_TIME</span><span class="o">/</span><span class="k">this</span><span class="p">.</span><span class="nx">time</span><span class="p">;</span>
          <span class="kd">var</span> <span class="nx">pow</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span><span class="o">/</span><span class="nb">Math</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))));</span>
          <span class="nx">count</span> <span class="o">*=</span> <span class="nx">pow</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">count</span> <span class="o">&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">MAX_COUNT</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Max count exceeded.  If this test uses a looping function, make sure the iteration loop is working properly.&#39;</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-38" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-38'>#</a>
          </div>
          <p>Exceptions are caught and displayed in the test UI</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="nx">e</span><span class="p">;</span>
      <span class="p">}</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-39" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-39'>#</a>
          </div>
          <p>Figure out what to do next</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">running</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">me</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="nx">count</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">jsl</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
        <span class="nx">me</span><span class="p">.</span><span class="nx">onStop</span><span class="p">(</span><span class="nx">me</span><span class="p">);</span>
      <span class="p">}</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-40" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-40'>#</a>
          </div>
          <p>Finish up</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">onChange</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-41" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-41'>#</a>
          </div>
          <p>Get the number of operations per second for this test.</p>
<p><span class="pydoc pydoc-param"><span>param</span> <code>normalize</code></span> if true, iteration loop overhead taken into account</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">getHz</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="cm">/**Boolean*/</span> <span class="nx">normalize</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">period</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-42" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-42'>#</a>
          </div>
          <p>Adjust period based on the calibration test time</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">normalize</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isCalibration</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">cal</span> <span class="o">=</span> <span class="nx">Test</span><span class="p">.</span><span class="nx">CALIBRATIONS</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">loopArg</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">];</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-43" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-43'>#</a>
          </div>
          <p>If the period is within 20% of the calibration time, then zero the
it out</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span> <span class="o">&lt;</span> <span class="nx">cal</span><span class="p">.</span><span class="nx">period</span><span class="o">*</span><span class="mf">1.2</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">p</span> <span class="o">-</span> <span class="nx">cal</span><span class="p">.</span><span class="nx">period</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nx">p</span><span class="p">);</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-44" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-44'>#</a>
          </div>
          <p>Get a friendly string describing the test</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">toString</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span>  <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">time</span><span class="o">/</span><span class="k">this</span><span class="p">.</span><span class="nx">count</span> <span class="o">+</span> <span class="s1">&#39; secs&#39;</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">});</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-45" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-45'>#</a>
          </div>
          <p>CSS we need for the UI</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">STYLESHEET</span> <span class="o">=</span> <span class="s1">&#39;&lt;style&gt; \</span>
<span class="s1">    #jslitmus {font-family:sans-serif; font-size: 12px;} \</span>
<span class="s1">    #jslitmus a {text-decoration: none;} \</span>
<span class="s1">    #jslitmus a:hover {text-decoration: underline;} \</span>
<span class="s1">    #jsl_status { \</span>
<span class="s1">      margin-top: 10px; \</span>
<span class="s1">      font-size: 10px; \</span>
<span class="s1">      color: #888; \</span>
<span class="s1">    } \</span>
<span class="s1">    A IMG  {border:none} \</span>
<span class="s1">    #test_results { \</span>
<span class="s1">      margin-top: 10px; \</span>
<span class="s1">      font-size: 12px; \</span>
<span class="s1">      font-family: sans-serif; \</span>
<span class="s1">      border-collapse: collapse; \</span>
<span class="s1">      border-spacing: 0px; \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results th, #test_results td { \</span>
<span class="s1">      border: solid 1px #ccc; \</span>
<span class="s1">      vertical-align: top; \</span>
<span class="s1">      padding: 3px; \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results th { \</span>
<span class="s1">      vertical-align: bottom; \</span>
<span class="s1">      background-color: #ccc; \</span>
<span class="s1">      padding: 1px; \</span>
<span class="s1">      font-size: 10px; \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results #test_platform { \</span>
<span class="s1">      color: #444; \</span>
<span class="s1">      text-align:center; \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results .test_row { \</span>
<span class="s1">      color: #006; \</span>
<span class="s1">      cursor: pointer; \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results .test_nonlooping { \</span>
<span class="s1">      border-left-style: dotted; \</span>
<span class="s1">      border-left-width: 2px; \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results .test_looping { \</span>
<span class="s1">      border-left-style: solid; \</span>
<span class="s1">      border-left-width: 2px; \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results .test_name {white-space: nowrap;} \</span>
<span class="s1">    #test_results .test_pending { \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results .test_running { \</span>
<span class="s1">      font-style: italic; \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results .test_done {} \</span>
<span class="s1">    #test_results .test_done { \</span>
<span class="s1">      text-align: right; \</span>
<span class="s1">      font-family: monospace; \</span>
<span class="s1">    } \</span>
<span class="s1">    #test_results .test_error {color: #600;} \</span>
<span class="s1">    #test_results .test_error .error_head {font-weight:bold;} \</span>
<span class="s1">    #test_results .test_error .error_body {font-size:85%;} \</span>
<span class="s1">    #test_results .test_row:hover td { \</span>
<span class="s1">      background-color: #ffc; \</span>
<span class="s1">      text-decoration: underline; \</span>
<span class="s1">    } \</span>
<span class="s1">    #chart { \</span>
<span class="s1">      margin: 10px 0px; \</span>
<span class="s1">      width: 250px; \</span>
<span class="s1">    } \</span>
<span class="s1">    #chart img { \</span>
<span class="s1">      border: solid 1px #ccc; \</span>
<span class="s1">      margin-bottom: 5px; \</span>
<span class="s1">    } \</span>
<span class="s1">    #chart #tiny_url { \</span>
<span class="s1">      height: 40px; \</span>
<span class="s1">      width: 250px; \</span>
<span class="s1">    } \</span>
<span class="s1">    #jslitmus_credit { \</span>
<span class="s1">      font-size: 10px; \</span>
<span class="s1">      color: #888; \</span>
<span class="s1">      margin-top: 8px; \</span>
<span class="s1">    } \</span>
<span class="s1">    &lt;/style&gt;&#39;</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-46" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-46'>#</a>
          </div>
          <p>HTML markup for the UI</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">MARKUP</span> <span class="o">=</span> <span class="s1">&#39;&lt;div id=&quot;jslitmus&quot;&gt; \</span>
<span class="s1">      &lt;button onclick=&quot;JSLitmus.runAll(event)&quot;&gt;Run Tests&lt;/button&gt; \</span>
<span class="s1">      &lt;button id=&quot;stop_button&quot; disabled=&quot;disabled&quot; onclick=&quot;JSLitmus.stop()&quot;&gt;Stop Tests&lt;/button&gt; \</span>
<span class="s1">      &lt;br \&gt; \</span>
<span class="s1">      &lt;br \&gt; \</span>
<span class="s1">      &lt;input type=&quot;checkbox&quot; style=&quot;vertical-align: middle&quot; id=&quot;test_normalize&quot; checked=&quot;checked&quot; onchange=&quot;JSLitmus.renderAll()&quot;&quot;&gt; Normalize results \</span>
<span class="s1">      &lt;table id=&quot;test_results&quot;&gt; \</span>
<span class="s1">        &lt;colgroup&gt; \</span>
<span class="s1">          &lt;col /&gt; \</span>
<span class="s1">          &lt;col width=&quot;100&quot; /&gt; \</span>
<span class="s1">        &lt;/colgroup&gt; \</span>
<span class="s1">        &lt;tr&gt;&lt;th id=&quot;test_platform&quot; colspan=&quot;2&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">platform</span> <span class="o">+</span> <span class="s1">&#39;&lt;/th&gt;&lt;/tr&gt; \</span>
<span class="s1">        &lt;tr&gt;&lt;th&gt;Test&lt;/th&gt;&lt;th&gt;Ops/sec&lt;/th&gt;&lt;/tr&gt; \</span>
<span class="s1">        &lt;tr id=&quot;test_row_template&quot; class=&quot;test_row&quot; style=&quot;display:none&quot;&gt; \</span>
<span class="s1">          &lt;td class=&quot;test_name&quot;&gt;&lt;/td&gt; \</span>
<span class="s1">          &lt;td class=&quot;test_result&quot;&gt;Ready&lt;/td&gt; \</span>
<span class="s1">        &lt;/tr&gt; \</span>
<span class="s1">      &lt;/table&gt; \</span>
<span class="s1">      &lt;div id=&quot;jsl_status&quot;&gt;&lt;/div&gt; \</span>
<span class="s1">      &lt;div id=&quot;chart&quot; style=&quot;display:none&quot;&gt; \</span>
<span class="s1">      &lt;a id=&quot;chart_link&quot; target=&quot;_blank&quot;&gt;&lt;img id=&quot;chart_image&quot;&gt;&lt;/a&gt; \</span>
<span class="s1">      TinyURL (for chart): \</span>
<span class="s1">      &lt;iframe id=&quot;tiny_url&quot; frameBorder=&quot;0&quot; scrolling=&quot;no&quot; src=&quot;&quot;&gt;&lt;/iframe&gt; \</span>
<span class="s1">      &lt;/div&gt; \</span>
<span class="s1">      &lt;a id=&quot;jslitmus_credit&quot; title=&quot;JSLitmus home page&quot; href=&quot;http://code.google.com/p/jslitmus&quot; target=&quot;_blank&quot;&gt;Powered by JSLitmus&lt;/a&gt; \</span>
<span class="s1">    &lt;/div&gt;&#39;</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-47" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-47'>#</a>
          </div>
          <p>The public API for creating and running tests</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>  <span class="nb">window</span><span class="p">.</span><span class="nx">JSLitmus</span> <span class="o">=</span> <span class="p">{</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-48" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-48'>#</a>
          </div>
          <p>The list of all tests that have been registered with JSLitmus.test </p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">_tests</span><span class="o">:</span> <span class="p">[],</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-49" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-49'>#</a>
          </div>
          <p>The queue of tests that need to be run </p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">_queue</span><span class="o">:</span> <span class="p">[],</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-50" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-50'>#</a>
          </div>
          <p>The parsed query parameters the current page URL.  This is provided as a
 convenience for test functions - it's not used by JSLitmus proper</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">params</span><span class="o">:</span> <span class="p">{},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-51" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-51'>#</a>
          </div>
          <p>Initialize</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-52" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-52'>#</a>
          </div>
          <p>Parse query params into JSLitmus.params[] hash</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">_init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

      <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="p">(</span><span class="nx">location</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">match</span><span class="p">(</span><span class="sr">/([^?#]*)(#.*)?$/</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">pairs</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">pairs</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">pair</span> <span class="o">=</span> <span class="nx">pairs</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">pair</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">pair</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
            <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">pair</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="nx">pair</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-53" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-53'>#</a>
          </div>
          <p>Write out the stylesheet.  We have to do this here because IE
doesn't honor sheets written after the document has loaded.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">STYLESHEET</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-54" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-54'>#</a>
          </div>
          <p>Setup the rest of the UI once the document is loaded</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_setup</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_setup</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">attachEvent</span><span class="p">(</span><span class="s1">&#39;onload&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_setup</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-55" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-55'>#</a>
          </div>
          <p>Set up the UI</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">_setup</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;jslitmus_container&#39;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">el</span><span class="p">)</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">el</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">));</span>

      <span class="nx">el</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">MARKUP</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-56" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-56'>#</a>
          </div>
          <p>Render the UI for all our tests</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
        <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">renderTest</span><span class="p">(</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-57" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-57'>#</a>
          </div>
          <p>(Re)render all the test results</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">renderAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
        <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">renderTest</span><span class="p">(</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
      <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">renderChart</span><span class="p">();</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-58" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-58'>#</a>
          </div>
          <p>(Re)render the chart graphics</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">renderChart</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">chartUrl</span><span class="p">();</span>
      <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;chart_link&#39;</span><span class="p">).</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
      <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;chart_image&#39;</span><span class="p">).</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
      <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;chart&#39;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-59" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-59'>#</a>
          </div>
          <p>Update the tiny URL</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;tiny_url&#39;</span><span class="p">).</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">&#39;http://tinyurl.com/api-create.php?url=&#39;</span><span class="o">+</span><span class="nx">escape</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-60" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-60'>#</a>
          </div>
          <p>(Re)render the results for a specific test</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-61" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-61'>#</a>
          </div>
          <p>Make a new row if needed</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">renderTest</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>

      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">test</span><span class="p">.</span><span class="nx">_row</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">trow</span> <span class="o">=</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;test_row_template&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">trow</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

        <span class="nx">test</span><span class="p">.</span><span class="nx">_row</span> <span class="o">=</span> <span class="nx">trow</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
        <span class="nx">test</span><span class="p">.</span><span class="nx">_row</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="nx">test</span><span class="p">.</span><span class="nx">_row</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-62" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-62'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="nx">test</span><span class="p">.</span><span class="nx">_row</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_queueTest</span><span class="p">(</span><span class="nx">test</span><span class="p">);};</span>
        <span class="nx">test</span><span class="p">.</span><span class="nx">_row</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s1">&#39;Run &#39;</span> <span class="o">+</span> <span class="nx">test</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39; test&#39;</span><span class="p">;</span>
        <span class="nx">trow</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">test</span><span class="p">.</span><span class="nx">_row</span><span class="p">);</span>
        <span class="nx">test</span><span class="p">.</span><span class="nx">_row</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">test</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
      <span class="p">}</span>

      <span class="kd">var</span> <span class="nx">cell</span> <span class="o">=</span> <span class="nx">test</span><span class="p">.</span><span class="nx">_row</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
      <span class="kd">var</span> <span class="nx">cns</span> <span class="o">=</span> <span class="p">[</span><span class="nx">test</span><span class="p">.</span><span class="nx">loopArg</span> <span class="o">?</span> <span class="s1">&#39;test_looping&#39;</span> <span class="o">:</span> <span class="s1">&#39;test_nonlooping&#39;</span><span class="p">];</span>

      <span class="k">if</span> <span class="p">(</span><span class="nx">test</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">cns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;test_error&#39;</span><span class="p">);</span>
        <span class="nx">cell</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> 
        <span class="s1">&#39;&lt;div class=&quot;error_head&quot;&gt;&#39;</span> <span class="o">+</span> <span class="nx">test</span><span class="p">.</span><span class="nx">error</span> <span class="o">+</span> <span class="s1">&#39;&lt;/div&gt;&#39;</span> <span class="o">+</span>
        <span class="s1">&#39;&lt;ul class=&quot;error_body&quot;&gt;&lt;li&gt;&#39;</span> <span class="o">+</span>
          <span class="nx">jsl</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">test</span><span class="p">.</span><span class="nx">error</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;/li&gt;&lt;li&gt;&#39;</span><span class="p">)</span> <span class="o">+</span>
          <span class="s1">&#39;&lt;/li&gt;&lt;/ul&gt;&#39;</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">test</span><span class="p">.</span><span class="nx">running</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">cns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;test_running&#39;</span><span class="p">);</span>
          <span class="nx">cell</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;running&#39;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">jsl</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_queue</span><span class="p">,</span> <span class="nx">test</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">cns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;test_pending&#39;</span><span class="p">);</span>
          <span class="nx">cell</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;pending&#39;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">test</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">cns</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;test_done&#39;</span><span class="p">);</span>
          <span class="kd">var</span> <span class="nx">hz</span> <span class="o">=</span> <span class="nx">test</span><span class="p">.</span><span class="nx">getHz</span><span class="p">(</span><span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;test_normalize&#39;</span><span class="p">).</span><span class="nx">checked</span><span class="p">);</span>
          <span class="nx">cell</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">hz</span> <span class="o">!=</span> <span class="kc">Infinity</span> <span class="o">?</span> <span class="nx">hz</span> <span class="o">:</span> <span class="s1">&#39;&amp;infin;&#39;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">cell</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">&#39;ready&#39;</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="nx">cell</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">cns</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-63" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-63'>#</a>
          </div>
          <p>Create a new test</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-64" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-64'>#</a>
          </div>
          <p>Create the Test object</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">test</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="p">{</span>

      <span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Test</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">f</span><span class="p">);</span>
      <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-65" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-65'>#</a>
          </div>
          <p>Re-render if the test state changes</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="nx">test</span><span class="p">.</span><span class="nx">onChange</span> <span class="o">=</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">renderTest</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-66" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-66'>#</a>
          </div>
          <p>Run the next test if this one finished</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="nx">test</span><span class="p">.</span><span class="nx">onStop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">onTestFinish</span><span class="p">)</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">onTestFinish</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
        <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">currentTest</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_nextTest</span><span class="p">();</span>
      <span class="p">};</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-67" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-67'>#</a>
          </div>
          <p>Render the new test</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">renderTest</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-68" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-68'>#</a>
          </div>
          <p>Add all tests to the run queue</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">runAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">e</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">||</span> <span class="nb">window</span><span class="p">.</span><span class="nx">event</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">reverse</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">&amp;&amp;</span> <span class="nx">e</span><span class="p">.</span><span class="nx">shiftKey</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_queueTest</span><span class="p">(</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">[</span><span class="o">!</span><span class="nx">reverse</span> <span class="o">?</span> <span class="nx">i</span> <span class="o">:</span> <span class="p">(</span><span class="nx">len</span> <span class="o">-</span> <span class="nx">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]);</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-69" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-69'>#</a>
          </div>
          <p>Remove all tests from the run queue.  The current test has to finish on
 it's own though</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">stop</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">while</span> <span class="p">(</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_queue</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_queue</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
        <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">renderTest</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-70" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-70'>#</a>
          </div>
          <p>Run the next test in the run queue</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">_nextTest</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">currentTest</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_queue</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;stop_button&#39;</span><span class="p">).</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">currentTest</span> <span class="o">=</span> <span class="nx">test</span><span class="p">;</span>
          <span class="nx">test</span><span class="p">.</span><span class="nx">run</span><span class="p">();</span>
          <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">renderTest</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">onTestStart</span><span class="p">)</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">onTestStart</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;stop_button&#39;</span><span class="p">).</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">renderChart</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-71" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-71'>#</a>
          </div>
          <p>Add a test to the run queue</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">_queueTest</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">test</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">jsl</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_queue</span><span class="p">,</span> <span class="nx">test</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
      <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_queue</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
      <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">renderTest</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
      <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_nextTest</span><span class="p">();</span>
    <span class="p">},</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-72" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-72'>#</a>
          </div>
          <p>Generate a Google Chart URL that shows the data for all tests</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>    <span class="nx">chartUrl</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">markers</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="kd">var</span> <span class="nx">d</span><span class="p">,</span> <span class="nx">min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">max</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="nx">e10</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">normalize</span> <span class="o">=</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;test_normalize&#39;</span><span class="p">).</span><span class="nx">checked</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-73" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-73'>#</a>
          </div>
          <p>Gather test data</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">test</span> <span class="o">=</span> <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_tests</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">test</span><span class="p">.</span><span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">hz</span> <span class="o">=</span> <span class="nx">test</span><span class="p">.</span><span class="nx">getHz</span><span class="p">(</span><span class="nx">normalize</span><span class="p">);</span>
          <span class="kd">var</span> <span class="nx">v</span> <span class="o">=</span> <span class="nx">hz</span> <span class="o">!=</span> <span class="kc">Infinity</span> <span class="o">?</span> <span class="nx">hz</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
          <span class="nx">data</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>
          <span class="nx">markers</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;t&#39;</span> <span class="o">+</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="nx">test</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">toLabel</span><span class="p">(</span><span class="nx">hz</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,000000,0,&#39;</span> <span class="o">+</span>
            <span class="nx">markers</span><span class="p">.</span><span class="nx">length</span> <span class="o">+</span> <span class="s1">&#39;,10&#39;</span><span class="p">);</span>
          <span class="nx">max</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">max</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">markers</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-74" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-74'>#</a>
          </div>
          <p>Build chart title</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">title</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
      <span class="nx">title</span> <span class="o">=</span> <span class="p">(</span><span class="nx">title</span> <span class="o">&amp;&amp;</span> <span class="nx">title</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="o">?</span> <span class="nx">title</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">chart_title</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="k">if</span> <span class="p">(</span><span class="nx">title</span><span class="p">)</span> <span class="nx">chart_title</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">title</span><span class="p">);</span>
      <span class="nx">chart_title</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;Ops/sec (&#39;</span> <span class="o">+</span> <span class="nx">platform</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">);</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-75" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-75'>#</a>
          </div>
          <p>Build labels</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">labels</span> <span class="o">=</span> <span class="p">[</span><span class="nx">jsl</span><span class="p">.</span><span class="nx">toLabel</span><span class="p">(</span><span class="nx">min</span><span class="p">),</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">toLabel</span><span class="p">(</span><span class="nx">max</span><span class="p">)];</span>

      <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span> <span class="nx">bw</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">bs</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
      <span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="nx">markers</span><span class="p">.</span><span class="nx">length</span><span class="o">*</span><span class="p">(</span><span class="nx">bw</span> <span class="o">+</span> <span class="nx">bs</span><span class="p">)</span> <span class="o">+</span> <span class="mi">30</span> <span class="o">+</span> <span class="nx">chart_title</span><span class="p">.</span><span class="nx">length</span><span class="o">*</span><span class="mi">20</span><span class="p">;</span>

      <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">chtt</span><span class="o">:</span> <span class="nx">escape</span><span class="p">(</span><span class="nx">chart_title</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)),</span>
        <span class="nx">chts</span><span class="o">:</span> <span class="s1">&#39;000000,10&#39;</span><span class="p">,</span>
        <span class="nx">cht</span><span class="o">:</span> <span class="s1">&#39;bhg&#39;</span><span class="p">,</span>                     <span class="c1">// chart type</span>
        <span class="nx">chd</span><span class="o">:</span> <span class="s1">&#39;t:&#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">),</span>     <span class="c1">// data set</span>
        <span class="nx">chds</span><span class="o">:</span> <span class="nx">min</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nx">max</span><span class="p">,</span>          <span class="c1">// max/min of data</span>
        <span class="nx">chxt</span><span class="o">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span>                      <span class="c1">// label axes</span>
        <span class="nx">chxl</span><span class="o">:</span> <span class="s1">&#39;0:|&#39;</span> <span class="o">+</span> <span class="nx">labels</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">),</span> <span class="c1">// labels</span>
        <span class="nx">chsp</span><span class="o">:</span> <span class="s1">&#39;0,1&#39;</span><span class="p">,</span>
        <span class="nx">chm</span><span class="o">:</span> <span class="nx">markers</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">),</span>         <span class="c1">// test names</span>
        <span class="nx">chbh</span><span class="o">:</span> <span class="p">[</span><span class="nx">bw</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">bs</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">),</span>    <span class="c1">// bar widths</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-76" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-76'>#</a>
          </div>
          <p>chf: 'bg,lg,0,eeeeee,0,eeeeee,.5,ffffff,1', // gradient</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="nx">chs</span><span class="o">:</span> <span class="nx">w</span> <span class="o">+</span> <span class="s1">&#39;x&#39;</span> <span class="o">+</span> <span class="nx">h</span>
      <span class="p">};</span>
      <span class="k">return</span> <span class="s1">&#39;http://chart.apis.google.com/chart?&#39;</span> <span class="o">+</span> <span class="nx">jsl</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
    <span class="p">}</span> 
  <span class="p">};</span>

  <span class="nx">JSLitmus</span><span class="p">.</span><span class="nx">_init</span><span class="p">();</span>
<span class="p">})();</span>

</pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
  </div>
</body>
